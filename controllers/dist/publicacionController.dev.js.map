{"version":3,"sources":["publicacionController.js"],"names":["PublicacionServicio","require","getPublicaciones","req","res","console","log","publicaciones","publicacionesProcesadas","map","pub","id","usuario_id","titulo","contenido","imagen","video","setHeader","json","title","error","status","crearPublicacion","body","files","buffer","isNaN","message","module","exports"],"mappings":"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","sourcesContent":["const PublicacionServicio = require('../servicio/publicacionServicio');\n\n// Obtener todas las publicaciones\nasync function getPublicaciones(req, res) {\n    try {\n        console.log('Solicitud recibida para obtener publicaciones');\n        const publicaciones = await PublicacionServicio.getPublicaciones();\n        console.log('Publicaciones obtenidas:', publicaciones);\n\n        const publicacionesProcesadas = publicaciones.map(pub => {\n            return {\n                id: pub.id,\n                usuario_id: pub.usuario_id,\n                titulo: pub.titulo,\n                contenido: pub.contenido,\n                imagen: pub.imagen ? `http://localhost:3000/publicaciones/imagen/${pub.id}` : null,\n                video: pub.video ? `http://localhost:3000/publicaciones/video/${pub.id}` : null\n            };\n        });\n\n        console.log('Publicaciones procesadas:', publicacionesProcesadas);\n\n        res.setHeader('Content-Type', 'application/json');\n        res.json({ title: 'Página Principal', publicaciones: publicacionesProcesadas });\n    } catch (error) {\n        console.error('Error al obtener publicaciones:', error);\n        res.status(500).json({ error: 'Error al obtener publicaciones' });\n    }\n}\n\n\nasync function crearPublicacion(req, res) {\n    console.log('Llamada a crearPublicacion');\n    const { usuario_id, titulo, contenido } = req.body;\n    const imagen = req.files && req.files['imagen'] ? req.files['imagen'][0].buffer : null;\n    const video = req.files && req.files['video'] ? req.files['video'][0].buffer : null;\n\n    // Validar usuario_id\n    if (!usuario_id || isNaN(usuario_id)) {\n        return res.status(400).json({ error: 'usuario_id es requerido y debe ser un número válido.' });\n    }\n\n    console.log('Datos de la nueva publicación:', {\n        usuario_id,\n        titulo,\n        contenido,\n        imagen: imagen ? 'Imagen recibida' : 'Sin imagen',\n        video: video ? 'Video recibido' : 'Sin video'\n    });\n\n    try {\n        await PublicacionServicio.crearPublicacion(usuario_id, titulo, contenido, imagen, video);\n        console.log('Publicación creada exitosamente');\n        res.status(201).json({ message: 'Publicación creada exitosamente' });\n    } catch (error) {\n        console.error('Error al crear publicación:', error);\n        res.status(500).json({ error: 'Error al crear publicación' });\n    }\n}\n\nmodule.exports = {\n    getPublicaciones,\n    crearPublicacion\n};\n"],"file":"publicacionController.dev.js"}