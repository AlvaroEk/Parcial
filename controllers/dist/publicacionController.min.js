"use strict";var PublicacionServicio=require("../servicio/publicacionServicio");function getPublicaciones(e,i){var o,c;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Solicitud recibida para obtener publicaciones"),e.next=4,regeneratorRuntime.awrap(PublicacionServicio.getPublicaciones({limite:10}));case 4:o=e.sent,console.log("Publicaciones obtenidas:",o),c=o.map(function(e){return{id:e.id,usuario_id:e.usuario_id,titulo:e.titulo,contenido:e.contenido,imagen:e.imagen?"http://localhost:3000/publicaciones/imagen/".concat(e.id):null,video:e.video?"http://localhost:3000/publicaciones/video/".concat(e.id):null}}),console.log("Publicaciones procesadas:",c),i.setHeader("Content-Type","application/json"),i.json({title:"Página Principal",publicaciones:c}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Error al obtener publicaciones:",e.t0),i.status(500).json({error:"Error al obtener publicaciones"});case 16:case"end":return e.stop()}},null,null,[[0,12]])}function crearPublicacion(i,o){var c,n,a,r,t,l;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Llamada a crearPublicacion"),c=i.body,n=c.usuario_id,a=c.titulo,r=c.contenido,t=i.files&&i.files.imagen?i.files.imagen[0].buffer:null,l=i.files&&i.files.video?i.files.video[0].buffer:null,console.log("Datos de la nueva publicación:",{usuario_id:n,titulo:a,contenido:r,imagen:t?"Imagen recibida":"Sin imagen",video:l?"Video recibido":"Sin video"}),e.prev=5,e.next=8,regeneratorRuntime.awrap(PublicacionServicio.crearPublicacion(n,a,r,t,l));case 8:console.log("Publicación creada exitosamente"),o.status(201).json({message:"Publicación creada exitosamente"}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(5),console.error("Error al crear publicación:",e.t0),o.status(500).json({error:"Error al crear publicación"});case 16:case"end":return e.stop()}},null,null,[[5,12]])}module.exports={getPublicaciones:getPublicaciones,crearPublicacion:crearPublicacion};
//# sourceMappingURL=publicacionController.min.js.map
