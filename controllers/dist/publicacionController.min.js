"use strict";var PublicacionServicio=require("../servicio/publicacionServicio");function getPublicaciones(e,i){var o,n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Solicitud recibida para obtener publicaciones"),e.next=4,regeneratorRuntime.awrap(PublicacionServicio.getPublicaciones());case 4:o=e.sent,console.log("Publicaciones obtenidas:",o),n=o.map(function(e){return{id:e.id,usuario_id:e.usuario_id,titulo:e.titulo,contenido:e.contenido,imagen:e.imagen?"http://localhost:3000/publicaciones/imagen/".concat(e.id):null,video:e.video?"http://localhost:3000/publicaciones/video/".concat(e.id):null}}),console.log("Publicaciones procesadas:",n),i.setHeader("Content-Type","application/json"),i.json({title:"Página Principal",publicaciones:n}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Error al obtener publicaciones:",e.t0),i.status(500).json({error:"Error al obtener publicaciones"});case 16:case"end":return e.stop()}},null,null,[[0,12]])}function crearPublicacion(i,o){var n,r,a,c,t,l;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Llamada a crearPublicacion"),n=i.body,r=n.usuario_id,a=n.titulo,c=n.contenido,t=i.files&&i.files.imagen?i.files.imagen[0].buffer:null,l=i.files&&i.files.video?i.files.video[0].buffer:null,!r||isNaN(r))return e.abrupt("return",o.status(400).json({error:"usuario_id es requerido y debe ser un número válido."}));e.next=6;break;case 6:return console.log("Datos de la nueva publicación:",{usuario_id:r,titulo:a,contenido:c,imagen:t?"Imagen recibida":"Sin imagen",video:l?"Video recibido":"Sin video"}),e.prev=7,e.next=10,regeneratorRuntime.awrap(PublicacionServicio.crearPublicacion(r,a,c,t,l));case 10:console.log("Publicación creada exitosamente"),o.status(201).json({message:"Publicación creada exitosamente"}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),console.error("Error al crear publicación:",e.t0),o.status(500).json({error:"Error al crear publicación"});case 18:case"end":return e.stop()}},null,null,[[7,14]])}module.exports={getPublicaciones:getPublicaciones,crearPublicacion:crearPublicacion};
//# sourceMappingURL=publicacionController.min.js.map
